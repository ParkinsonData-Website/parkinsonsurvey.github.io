<!DOCTYPE html>
<html>
<head>
  <meta charset='utf-8'>
  <meta name='viewport' content='width=device-width, initial-scale=1'>
  <meta name="description" content="PD tests">
  <title>PD Survey - Information collection</title>
  <link rel="stylesheet" href="../css/styles.css">
  <link rel="stylesheet" href="../css/utility.css">
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link rel="icon" type="image/x-icon" href="pacman-favicon.png">
  <link href="https://fonts.googleapis.com/css2?family=Finlandica&display=swap" rel="stylesheet">
  <link href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/css/bootstrap-select.min.css">
  <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
  <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
  <style>
    .form-container {
      background-color: #f0f0f0;
      padding: 20px;
      border-radius: 10px;
    }
    .question-label {
      font-size: 1.4rem;
      font-weight: bold;
      text-align: left;
      margin-bottom: 0.5rem;
    }
    .form-control, .btn-custom, .btn-lg {
      font-size: 1.2rem;
    }
    .btn-custom {
      background-color: rgb(9, 136, 240);
      color: white;
      padding: 0.75rem 1.5rem;
    }
    .btn-success {
      background-color: darkgreen;
    }
    .button-group {
      display: flex;
      justify-content: center;
      gap: 1rem;
    }
  </style>
</head>

<body>
    <nav class="navbar navbar-expand-sm navbar-dark sticky-top" style="background-color: #13512f !important">
    <p class="navbar-brand">Parkinson's Survey</p>
    <div class="collapse navbar-collapse" id="navbarNav">
      <ul class="navbar-nav">
        <li class="nav-item">
          <a class="nav-link" href="../src/index.html">Home</a>
        </li>
        <li class="nav-item">
          <a class="nav-link" href="../src/about.html">About</a>
        </li>
      </ul>
    </div>
  </nav>

  <div class="container mt-5">
    <h1 class="text-center mb-4">Please enter your information below!</h1>

    <div class="form-container">
      <form>
        <div class="form-group">
          <label class="question-label">What is your age?</label>
          <input type="text" class="form-control" id="age" value="65">
          <div class="text-danger" id="ageError"></div>
        </div>
        <div class="form-group">
          <label class="question-label">What is your Height (in cm)?</label>
          <br>
          <input type="number" class="form-control" id="height" name="height" value = "170">
          <div class="text-danger" id="heightError"></div>
        </div>

        <div class="form-group">
          <label class="question-label">What is your Gender?</label>
          <select class="form-control" id="gender">
            <option value="Male">Male</option>
            <option value="Female">Female</option>
            <option value="Other">Other</option>
          </select>
          <div class="text-danger" id="genderError"></div>
        </div>

        <div class="form-group">
          <label class="question-label">What is your Race/ethnicity?</label>
          <select class="form-control" id="race">
            <option value="American Indian or Alaska Native">American Indian or Alaska Native</option>
            <option value="Asian">Asian</option>
            <option value="Black or African American">Black or African American</option>
            <option value="Native Hawaiian or Other Pacific Islander">Native Hawaiian or Other Pacific Islander</option>
            <option value="White">White</option>
            <option value="Prefer not to specify">Prefer not to specify</option>
          </select>
          <div class="text-danger" id="raceError"></div>
        </div>
        <!-- Medications Dropdown -->
        <div class="form-group">
          <label class="question-label">What Medications are you taking for Parkinson’s Treatment:</label>
          <select multiple class="form-control selectpicker" id="medications" data-live-search="true">
            <option value="N/A" id="medicationNA" selected>N/A</option>
            <option value="Levodopa">Levodopa / Rytary / Sinemet / Duopa</option>
            <option value="Dopamine Agonists">Dopamine Agonists (Ropinirole, Mirapexin, Apomorphine (Apokyn), Rotigotine (Neupro))</option>
            <option value="MAO-B Inhibitors">MAO-B Inhibitors (Rasagiline(Zelapar), Selegiline(Neupro)(Azilect), Safinamide(Xadago))</option>
            <option value="COMT inhibitors">COMT inhibitors: Entacapone (Comtan), Opicapone (Ongentys)</option>
            <option value="Anticholinergics">Anticholinergics: Benztropine (Cogentin), Trihexyphenidyl</option>
            <option value="Amantadine">Amantadine (Gocovri)</option>
            <option value="A2A receptor antagonists">A2A receptor antagonists: Istradefylline (Nourianz)</option>
            <option value="Nuplazid">Nuplazid (Pimavanserin)</option>
            <option value="Botulinum Toxin Injections">Botulinum Toxin Injections</option>
          </select>
          <div class="text-danger" id="medicationsError"></div>
        </div>

        <!-- Alternative Therapies Dropdown -->
        <div class="form-group">
          <label class="question-label">What alternative treatments are you taking for for Parkinson's:</label>
          <select multiple class="form-control selectpicker" id="therapies" data-live-search="true">
            <option value="N/A" id="therapiesNA" selected>N/A</option>
            <option value="Deep brain stimulation">Deep brain stimulation</option>
            <option value="MRgFUS">MRgFUS (MRI-guided focused ultrasound)</option>
            <option value="Physical Therapy">Physical Therapy</option>
            <option value="Speech Therapy">Speech Therapy (Lee Silverman Voice Treatment (LSVT))</option>
          </select>
          <div class="text-danger" id="therapiesError"></div>
        </div>
        <div class="form-group">
          <label class="question-label">How long ago did you take your last medication dosage? (in hours)</label>
          <input type="number" class="form-control" id="medicationTiming" placeholder="Enter hours" min="0">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="naCheckbox">
            <label class="form-check-label" for="naCheckbox">
              <h4>N/A</h4>
            </label>
          </div>
          <div class="text-danger" id="medicationTimingError"></div>
        </div>
        <!-- New Section: Neurological or Motor Condition -->
        <div class="form-group">
          <label class="question-label">Do you have any neurological or motor condition?</label>
          <input type="text" class="form-control" id="neuroCondition" placeholder="Enter your condition">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="neuroConditionNA">
            <label class="form-check-label" for="neuroConditionNA"><h4>N/A</h4></label>
          </div>
          <div class="text-danger" id="neuroConditionError"></div>
        </div>

        <!-- New Section: Other Health Conditions -->
        <div class="form-group">
          <label class="question-label">Do you have any other health condition you want to mention?</label>
          <input type="text" class="form-control" id="otherHealthCondition" placeholder="Enter your condition">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="otherHealthConditionNA">
            <label class="form-check-label" for="otherHealthConditionNA"><h4>N/A</h4></label>
          </div>
          <div class="text-danger" id="otherHealthConditionError"></div>
        </div>
        <!-- Parkinson's Status -->
        <div class="form-group">
          <label class="question-label">Do you have Parkinsons?</label>
          <div class="button-group" id="parkinsonsStatus">
            <button type="button" class="btn btn-custom" id="yesButton" onclick="storestatus('pd')">Yes</button>
            <button type="button" class="btn btn-custom" id="noButton" onclick="storestatus('nonpd')">No</button>
            <button type="button" class="btn btn-custom" id="suspectedButton" onclick="storestatus('suspectedpd')">Suspected but not Diagnosed</button>            
          </div>
          <div class="text-danger" id="parkinsonsError"></div>
        </div>
        <!-- Time Since Diagnosis -->
        <div class="form-group">
          <label class="question-label">How long ago were you diagnosed with Parkinson's (in years)?</label>
          <input type="number" class="form-control" id="timeSinceDiagnosis" placeholder="Enter years" min="0">
          <div class="form-check">
            <input class="form-check-input" type="checkbox" id="diagnosisNACheckbox">
            <label class="form-check-label" for="diagnosisNACheckbox">
              <h4>N/A</h4>
            </label>
          </div>
          <div class="text-danger" id="timeSinceDiagnosisError"></div>
        </div>
        <!-- Dominant Hand -->
        <div class="form-group">
          <label class="question-label">Which is your dominant hand?</label>
          <div class="button-group" id="dominantHand">
            <button type="button" class="btn btn-custom" id="leftHandButton" onclick="storeHand('Left')">Left</button>
            <button type="button" class="btn btn-custom" id="rightHandButton" onclick="storeHand('Right')">Right</button>            
          </div>
          <div class="text-danger" id="handError"></div>
        </div>

        <div class="text-center">
          <button type="button" class="btn btn-primary btn-lg btn-custom" id="submitForm">Start the Survey</button>
        </div>
      </form>
    </div>
  </div>

  <div class="blocker" id='blocker'></div>

  <div class="largenotif" id="verify">
    <h1>Please verify the following information</h1>
    <div class="verify-content">
      <h2 id="aged">Age:</h2>
      <h2 id="gend">Gender:</h2>
      <h2 id="raced">Race:</h2>
      <h2 id="medicationsDisplay">Medications:</h2>
      <h2 id="therapiesDisplay">Therapies:</h2>
      <h2 id="medicationTimingDisplay">Last Medication Timing:</h2>
      <h2 id="neuroConditionDisplay">Neurological or Motor Condition:</h2>
      <h2 id="otherHealthConditionDisplay">Other Health Condition:</h2>
      <h2 id="pdd">Parkinson’s Status:</h2>
      <h2 id="timeSinceDiagnosisDisplay">Time Since Diagnosis:</h2>
      <h2 id="dominantHandDisplay">Dominant Hand:</h2>
      <h2 id="heightd">Height:</h2>

    </div>
    <button class="btn btn-success btn-verify" id='ttrs' onclick="commencetests();">This is correct, start test!</button>
    <button class="btn btn-danger btn-verify" onclick="closeverify();">Cancel</button>
  </div>

  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.0.0/firebase-firestore.js"></script>
  <script src="../js_practice/collector.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/bootstrap-select/1.13.1/js/bootstrap-select.min.js"></script>
  <script>
    $(document).ready(function() {
      $('.selectpicker').selectpicker();
    });
    document.getElementById('naCheckbox').addEventListener('change', function() {
      let medicationTimingInput = document.getElementById('medicationTiming');
      medicationTimingInput.disabled = this.checked;
      if (this.checked) {
        medicationTimingInput.value = '';
      }
    });
    document.getElementById('diagnosisNACheckbox').addEventListener('change', function() {
      let timeSinceDiagnosisInput = document.getElementById('timeSinceDiagnosis');
      timeSinceDiagnosisInput.disabled = this.checked;
      if (this.checked) {
        timeSinceDiagnosisInput.value = '';
      }
    });
    document.getElementById('neuroConditionNA').addEventListener('change', function() {
      let neuroConditionInput = document.getElementById('neuroCondition');
      neuroConditionInput.disabled = this.checked;
      if (this.checked) {
        neuroConditionInput.value = '';
      }
    });
    document.getElementById('otherHealthConditionNA').addEventListener('change', function() {
      let otherHealthConditionInput = document.getElementById('otherHealthCondition');
      otherHealthConditionInput.disabled = this.checked;
      if (this.checked) {
        otherHealthConditionInput.value = '';
      }
    });
    document.addEventListener('DOMContentLoaded', function() {
      $('.selectpicker').selectpicker();

      function handleDropdownChange(dropdownId) {
        let selectedOptions = $(`#${dropdownId}`).val();
        if (selectedOptions && selectedOptions.includes('N/A')) {
          // If N/A is selected along with other options, remove N/A
          if (selectedOptions.length > 1) {
            $(`#${dropdownId}`).selectpicker('val', selectedOptions.filter(option => option !== 'N/A'));
          }
        }
      }

      // Event listener for Medications dropdown
      $('#medications').on('changed.bs.select', function() {
        handleDropdownChange('medications');
      });

      // Event listener for Therapies dropdown
      $('#therapies').on('changed.bs.select', function() {
        handleDropdownChange('therapies');
      });
    });
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize selectpicker
      $('.selectpicker').selectpicker();

      // Form submission handler
      document.getElementById('submitForm').addEventListener('click', function(event) {
        event.preventDefault(); // Prevent form submission
        if (validateForm()) {
          console.log('Form is valid');
          startverify();
        }
      });

      // Button group selection for Parkinson's and Dominant Hand
      document.querySelectorAll('.button-group button').forEach(function(button) {
        button.addEventListener('click', function() {
          let group = this.parentElement.id;
          document.querySelectorAll('#' + group + ' button').forEach(btn => btn.classList.remove('active'));
          this.classList.add('active');
          // Clear error message
          document.getElementById(group + 'Error').textContent = '';
        });
      });
    });

    function validateForm() {
      let isValid = true;

      // Validate Age
      if (!$('#age').val().trim()) {
        $('#ageError').text('Please enter your age.');
        isValid = false;
      } else {
        $('#ageError').text('');
      }

      // Validate Height
      if (!$('#height').val().trim()) {
        $('#heightError').text('Please enter your height.');
        isValid = false;
      } else {
        $('#heightError').text('');
      }

      // Validate Gender
      if ($('#gender').val() === '') {
        $('#genderError').text('Please select your gender.');
        isValid = false;
      } else {
        $('#genderError').text('');
      }

      // Validate Race/Ethnicity
      if ($('#race').val() === '') {
        $('#raceError').text('Please select your race/ethnicity.');
        isValid = false;
      } else {
        $('#raceError').text('');
      }

      // Validate Medications
      if ($('#medications').val() === null || $('#medications').val().length === 0) {
        $('#medicationsError').text('Please select your medications.');
        isValid = false;
      } else {
        $('#medicationsError').text('');
      }

      // Validate Therapies
      if ($('#therapies').val() === null || $('#therapies').val().length === 0) {
        $('#therapiesError').text('Please select your therapies.');
        isValid = false;
      } else {
        $('#therapiesError').text('');
      }

      // Validate Last Medication Timing
      if (!$('#naCheckbox').is(':checked') && !$('#medicationTiming').val().trim()) {
        $('#medicationTimingError').text('Please enter the last medication timing.');
        isValid = false;
      } else {
        $('#medicationTimingError').text('');
      }

      // Validate Parkinson's Status
      if ($('#parkinsonsStatus .active').length === 0) {
        $('#parkinsonsError').text('Please select your Parkinson’s status.');
        isValid = false;
      } else {
        $('#parkinsonsError').text('');
      }
      // Validate Time Since Diagnosis
      if (!$('#diagnosisNACheckbox').is(':checked') && !$('#timeSinceDiagnosis').val().trim()) {
        $('#timeSinceDiagnosisError').text('Please enter the time since diagnosis.');
        isValid = false;
      } else {
        $('#timeSinceDiagnosisError').text('');
      }
      // Validate Dominant Hand
      if ($('#dominantHand .active').length === 0) {
        $('#handError').text('Please select your dominant hand.');
        isValid = false;
      } else {
        $('#handError').text('');
      }

      // Validate Neurological or Motor Condition
      if (!$('#neuroConditionNA').is(':checked') && !$('#neuroCondition').val().trim()) {
        $('#neuroConditionError').text('Please enter your neurological or motor condition.');
        isValid = false;
      } else {
        $('#neuroConditionError').text('');
      }

      // Validate Other Health Condition
      if (!$('#otherHealthConditionNA').is(':checked') && !$('#otherHealthCondition').val().trim()) {
        $('#otherHealthConditionError').text('Please enter your other health condition.');
        isValid = false;
      } else {
        $('#otherHealthConditionError').text('');
      }

      return isValid;
    }
  </script>
    <footer class="footer">
      <div class="container text-center">
          <p>&copy; 2024 Hawaii Digital Health Lab</p>
      </div>
  </footer>
</body>
</html>
